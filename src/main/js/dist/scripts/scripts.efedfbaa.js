"use strict";var baseUrl="";angular.module("dominionFrontendApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/games/:game",{templateUrl:"views/game.html",controller:"GameCtrl",resolve:{game:["$route","$resource","$q",function(a,b,c){var d=c.defer(),e=b(baseUrl+"/dominion/:gameId"),f=a.current.params.game;return e.get({gameId:f},function(a){d.resolve(a)}),d.promise}],playerId:function(){return null}}}).when("/games/:game/players/:player",{templateUrl:"views/game.html",controller:"GameCtrl",resolve:{game:["$route","$resource","$q",function(a,b,c){var d=c.defer(),e=b(baseUrl+"/dominion/:gameId"),f=a.current.params.game;return e.get({gameId:f},function(a){d.resolve(a)}),d.promise}],playerId:["$route",function(a){return a.current.params.player}]}}).otherwise({redirectTo:"/"})}]).config(["$resourceProvider",function(a){a.defaults.stripTrailingSlashes=!1}]),angular.module("dominionFrontendApp").controller("MainCtrl",["$scope","$http","$resource","$route",function(a,b,c,d){var e="",f=c(e+"/dominion/");a.games=[],a.getGames=function(){return b.get(e+"/dominion/").success(function(b){a.games=b})},a.createGame=function(){var b=new f({});b.$save(a.getGames,d.reload)},a.getGames()}]),angular.module("dominionFrontendApp").controller("GameCtrl",["$scope","$http","$resource","$route","game","playerId",function(a,b,c,d,e,f){var g="";a.game=e,a.test=!1;var h=function(a,b){var c=e.kingdom.cardMarket[a][0],d=e.kingdom.cardMarket[b][0];return c.kingdomSortOrder==d.kingdomSortOrder?0:c.kingdomSortOrder>d.kingdomSortOrder?1:-1},i=function(a,b){var c=e.kingdom.cardMarket[a][0],d=e.kingdom.cardMarket[b][0];return c.cost.money==d.cost.money?0:c.cost.money>d.cost.money?1:-1};a.commonCards=Object.keys(e.kingdom.cardMarket).filter(function(a){return!e.kingdom.cardMarket[a][0].isKingdom}).sort(h),a.kingdomCards=Object.keys(e.kingdom.cardMarket).filter(function(a){return e.kingdom.cardMarket[a][0].isKingdom}).sort(i),a.shuffle=function(){var a=c(g+"/dominion/:gameId/:playerId/shuffle");a.get({gameId:e.id,playerId:f},function(){d.reload()})},a.drawHand=function(){var a=c(g+"/dominion/:gameId/:playerId/draw");a.get({gameId:e.id,playerId:f},function(){d.reload()})},a.discardHand=function(){var a=c(g+"/dominion/:gameId/:playerId/discard");a.get({gameId:e.id,playerId:f},d.reload)},a.canAfford=function(b){return a.getCurrentPlayer()&&a.game.turn.money>=b.cost.money},a.purchase=function(a){var b=c(g+"/dominion/:gameId/:playerId/purchase"),h=new b(a);h.$save({gameId:e.id,playerId:f},d.reload)},a.play=function(a){var b=c(g+"/dominion/:gameId/:playerId/play"),h=new b(a);h.$save({gameId:e.id,playerId:f},d.reload)},a.nextPhase=function(a){var b=c(g+"/dominion/:gameId/next-phase"),f=new b(a);f.$save({gameId:e.id},d.reload)},a.choose=function(a,b,e,f){var h=c(g+"/dominion/:gameId/:playerId/choice"),i=new h;switch(e.expectedAnswerType){case"CARD":i.targetChoice=e.id,i.card=f;break;case"YES_OR_NO":i.isYesOrNo=f}"CARD"==e.expectedAnswerType,i.$save({gameId:a.id,playerId:b.id},d.reload)},a.chooseDone=function(a,b){var e=c(g+"/dominion/:gameId/:playerId/choice"),f=new e;f.done=!0,f.$save({gameId:a.id,playerId:b.id},d.reload)},a.isCurrentPlayer=function(a){return a.id===f},a.isActivePlayer=function(a){return e.turn.playerId===a.id},a.hasCurrentPlayer=function(){return e&&e.players&&e.players.hasOwnProperty(f)},a.getCurrentPlayer=function(){return a.hasCurrentPlayer()?a.game.players[f]:void 0},a.hasCardType=function(a,b){b.cardTypes.includes(a)},a.getChoices=function(a){for(var b in e.choices)if(b.target==a.id)return b},a.getImagePath=function(a){return"/images/"+a.name.toLowerCase().replace(/\s/g,"")+".jpg"}}]);