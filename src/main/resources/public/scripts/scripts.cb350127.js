"use strict";angular.module("dominionFrontendApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","restangular"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/games/:game",{templateUrl:"views/game.html",controller:"GameCtrl",resolve:{game:["$route","$resource",function(a,b){var c=b("http://localhost:8001/dominion/:gameId"),d=a.current.params.game;return c.get({gameId:d})}],playerId:function(){return null}}}).when("/games/:game/players/:player",{templateUrl:"views/game.html",controller:"GameCtrl",resolve:{game:["$route","$resource","$q",function(a,b,c){var d=c.defer(),e=b("http://localhost:8001/dominion/:gameId"),f=a.current.params.game;return e.get({gameId:f},function(a){d.resolve(a)}),d.promise}],playerId:["$route",function(a){return a.current.params.player}]}}).otherwise({redirectTo:"/"})}]).config(["$resourceProvider",function(a){a.defaults.stripTrailingSlashes=!1}]),angular.module("dominionFrontendApp").controller("MainCtrl",["$scope","$http","$resource","$route",function(a,b,c,d){var e=c("http://localhost:8001/dominion/");a.games=[],a.getGames=function(){return b.get("http://localhost:8001/dominion/").success(function(b){a.games=b})},a.createGame=function(){var b=new e({});b.$save(a.getGames,d.reload)},a.getGames()}]),angular.module("dominionFrontendApp").controller("GameCtrl",["$scope","$http","$resource","$route","game","playerId",function(a,b,c,d,e,f){a.game=e,a.shuffle=function(){var a=c("http://localhost:8001/dominion/:gameId/:playerId/shuffle");a.get({gameId:e.id,playerId:f},function(){d.reload()})},a.drawHand=function(){var a=c("http://localhost:8001/dominion/:gameId/:playerId/draw");a.get({gameId:e.id,playerId:f},function(){d.reload()})},a.discardHand=function(){var a=c("http://localhost:8001/dominion/:gameId/:playerId/discard");a.get({gameId:e.id,playerId:f},d.reload)},a.purchase=function(a){var b=c("http://localhost:8001/dominion/:gameId/:playerId/purchase"),g=new b(a);g.$save({gameId:e.id,playerId:f},d.reload)},a.nextPhase=function(a){var b=c("http://localhost:8001/dominion/:gameId/next-phase"),f=new b(a);f.$save({gameId:e.id},d.reload)},a.canAfford=function(b){return a.getCurrentPlayer()&&a.getCurrentPlayer().money>=b.cost.money},a.isCurrentPlayer=function(a){return a.id===f},a.isActivePlayer=function(a){return e.active.id===a.id},a.hasCurrentPlayer=function(){return e&&e.players&&e.players.hasOwnProperty(f)},a.getCurrentPlayer=function(){return a.hasCurrentPlayer()?a.game.players[f]:void 0}}]);