---
- hosts: webservers
  remote_user: root
  gather_facts: no
  tasks:
  - name: start mongo
    command: docker-compose -f /root/javaminion/docker-compose.yml up -d mongo
  - name: testing javaminion
    command: docker-compose -f /root/javaminion/docker-compose.yml run app ./gradlew test
  - name: copy test log to host
    command: /root/javaminion/scripts/copy_test_log_from_docker.sh
  - name: fetching test result html
    fetch:
      src: /root/index.html
      dest: ../../logs/test-result.html